!function(){class t extends HTMLElement{constructor(){super(),this.addEventListener("change",this.onVariantChange)}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.toggleAddButton(!0,"","-loading"),this.removeErrorMessage(),this.currentVariant?(this.updateURL(),this.updateVariantInput(),this.renderProductInfo()):(this.toggleAddButton(!0,"","-disabled"),this.setUnavailable())}updateOptions(){this.options=Array.from(this.querySelectorAll("select"),(t=>t.value))}updateMasterId(){this.currentVariant=this.getVariantData().find((t=>!t.options.map(((t,e)=>this.options[e]===t)).includes(!1)))}updateURL(){this.currentVariant&&"false"!==this.dataset.updateUrl&&window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateShareUrl(){const t=document.getElementById(`Share-${this.dataset.section}`);t&&t.updateUrl(`${window.shopUrl}${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment`).forEach((t=>{const e=t.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))}))}removeErrorMessage(){const t=this.closest("section");if(!t)return;const e=t.querySelector("product-form");e&&e.handleErrorMessage(!this.currentVariant.available&&"No disponible")}renderProductInfo(){fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then((t=>t.text())).then((t=>{const e=`price-${this.dataset.section}`,a=(new DOMParser).parseFromString(t,"text/html"),n=document.getElementById(e),r=a.getElementById(e);r&&n&&(n.innerHTML=r.innerHTML);const i=document.getElementById(e);i&&i.classList.remove("u-hide"),i.outerHTML=a.getElementById(`price-${this.dataset.section}`).outerHTML,this.toggleAddButton(!this.currentVariant.available,this.currentVariant.available?"Agregar al carrito":"Agotado","-loading")}))}toggleAddButton(t=!0,e,a=!0){const n=document.getElementById(`product-form-${this.dataset.section}`);if(!n)return;const r=n.querySelector('[name="add"]');n.querySelector('[name="add"] > span'),r&&(t?r.setAttribute("disabled","disabled"):r.removeAttribute("disabled"),a&&(t?r.classList.add(a):r.classList.remove(a)))}setUnavailable(){const t=document.getElementById(`product-form-${this.dataset.section}`),e=t.querySelector('[name="add"]'),a=t.querySelector('[name="add"] > span'),n=document.getElementById(`price-${this.dataset.section}`);e&&(a.textContent=window.variantStrings.unavailable,n&&n.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}}customElements.define("variant-selects",t)}();